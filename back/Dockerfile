FROM node:buster-slim
WORKDIR /api

COPY package*.json /api/
RUN npm i

COPY . /api/

ARG AWS_ACCESS_ID
ENV AWS_ACCESS_ID ${AWS_ACCESS_ID}
ARG AWS_ACCESS_SECRET
ENV AWS_ACCESS_SECRET=${AWS_ACCESS_SECRET}
ARG AWS_BUCKET_NAME
ENV AWS_BUCKET_NAME=${AWS_BUCKET_NAME}
ARG MONGO_URI
ENV MONGO_URI=${MONGO_URI}
ARG MONGO_DB_NAME
ENV MONGO_DB_NAME=${MONGO_DB_NAME}
ARG MONGO_COLLECTION
ENV MONGO_COLLECTION=${MONGO_COLLECTION}
ARG PORT
ENV PORT=${PORT}

EXPOSE ${PORT}
CMD ["npm", "run", "build"]


FROM node:buster-slim
WORKDIR /api

COPY package*.json /api/
RUN npm i

COPY . /api/

ARG AUTH_BASE_URL
ENV AUTH_BASE_URL ${AUTH_BASE_URL}
ARG AUTH_API_SECRET_KEY
ENV AUTH_API_SECRET_KEY=${AUTH_API_SECRET_KEY}
ARG EMAIL_USER
ENV EMAIL_USER=${EMAIL_USER}
ARG EMAIL_SENDER
ENV EMAIL_SENDER=${EMAIL_SENDER}
ARG EMAIL_PASSWORD
ENV EMAIL_PASSWORD=${EMAIL_PASSWORD}
ARG EMAIL_SERVICE
ENV EMAIL_SERVICE=${EMAIL_SERVICE}
ARG MONGO_URI
ENV MONGO_URI=${MONGO_URI}
ARG PORT
ENV PORT=${PORT}

EXPOSE ${PORT}
CMD ["npm", "run", "build"]

